---
title: PFCPDFImage Class
description: Class representing an image extracted from a PDF file
---

# PFCPDFImage Class

The `PFCPDFImage` class represents an image extracted from a PDF file through `PFCPDFImageIterator`. It provides access to the image data for correction and handles embedding the corrected image back into the PDF.

## Class Definition

```cpp
class PFCPDFImage {
public:
    PFCPDFImage();
    ~PFCPDFImage();
    
    // Image access
    PFCImageFile* imageFile;              // The expanded image
    uint32_t pdfObjectNumber;             // PDF object ID
    
    // Compression settings
    int iQuality;                         // JPEG quality for re-embedding
    bool bConvertToOriginalColorSpace;    // Color space handling
    bool bEmbedOriginalMetadata;          // Metadata handling
    
    // Raw data access
    void* compressedBuffer();
    int compressedBufferSize;
    
    // Advanced usage
    PoDoFo::PdfObject* pdfObject();
    void setCompressedBuffer(void* buffer, int size, int width, int height);
    void setCompressedBufferPath(const char* path, int width, int height);
};
```

## Members

### Image Access

| Member | Type | Description |
|--------|------|-------------|
| `imageFile` | PFCImageFile* | The expanded image for processing |
| `pdfObjectNumber` | uint32_t | Unique object number in the PDF |

### Compression Settings

| Member | Type | Default | Description |
|--------|------|---------|-------------|
| `iQuality` | int | 92 | JPEG quality for re-embedding |
| `bConvertToOriginalColorSpace` | bool | true | Preserve original color space |
| `bEmbedOriginalMetadata` | bool | true | Preserve image metadata |

### Raw Data Access

| Member | Type | Description |
|--------|------|-------------|
| `compressedBuffer()` | void* | Raw compressed bytes |
| `compressedBufferSize` | int | Size of compressed buffer |

## Basic Usage

```cpp
#include "PFCPDFImageIterator.h"
#include "PFCPDFImage.h"
#include "PFCImageFile.h"

PFCPDFImageIterator iterator;
iterator.load("document.pdf");

PFCPDFImage* pdfImage;
while ((pdfImage = iterator.nextImage()) != nullptr) {
    // Access the image through imageFile
    PFCImageFile* img = pdfImage->imageFile;
    
    printf("Image %u: %dx%d\n", 
           pdfImage->pdfObjectNumber, 
           img->width, img->height);
    
    // Create PFCIMAGE for correction
    PFCIMAGE im;
    im.width = img->width;
    im.height = img->height;
    im.stride = img->stride;
    im.format = PFC_PixelFormat24bppBGR;
    im.data = img->raw_image;
    
    // Apply corrections
    PFC_AutoCorrect(&im, NULL, &param, &engine, NULL, 0, 0);
    
    // Set quality for re-embedding
    pdfImage->iQuality = 92;
}

// Save the modified PDF
iterator.save("output.pdf");
```

## Working with Raw Compressed Data

For advanced use cases, you can work directly with compressed JPEG data:

### Reading Raw Data

```cpp
PFCPDFImage* pdfImage = iterator.nextImage();

// Get raw JPEG bytes
void* jpegData = pdfImage->compressedBuffer();
int jpegSize = pdfImage->compressedBufferSize;

// Process externally...
```

### Setting Custom Compressed Data

```cpp
// Set from memory buffer
unsigned char* newJpegData = /* your processed JPEG */;
int newSize = /* size of new JPEG */;

pdfImage->setCompressedBuffer(newJpegData, newSize, width, height);
```

### Setting from File

```cpp
// Set from file on disk
pdfImage->setCompressedBufferPath("/path/to/processed.jpg", width, height);
```

## Quality Settings

The `iQuality` setting affects how the image is re-embedded into the PDF:

```cpp
pdfImage->iQuality = 95;  // High quality (larger file)
pdfImage->iQuality = 85;  // Balanced
pdfImage->iQuality = 75;  // Smaller file size
```

<Callout type="info">
The default quality of 92 provides a good balance between file size and image quality. Use higher values for print workflows.
</Callout>

## Color Space Handling

```cpp
// Keep original color space (recommended)
pdfImage->bConvertToOriginalColorSpace = true;

// Force sRGB output
pdfImage->bConvertToOriginalColorSpace = false;
```

## PDF Object Access

For advanced PDF manipulation using the underlying PoDoFo library:

```cpp
#include <podofo/podofo.h>

PFCPDFImage* pdfImage = iterator.nextImage();
PoDoFo::PdfObject* obj = pdfImage->pdfObject();

// Use PoDoFo API for advanced manipulation
```

## Memory Management

<Callout type="warn">
The `PFCPDFImage` object is owned by `PFCPDFImageIterator` and is invalidated when `nextImage()` is called again. Do not store references to `PFCPDFImage` beyond the current iteration.
</Callout>

```cpp
// WRONG - don't do this
std::vector<PFCPDFImage*> images;
while ((pdfImage = iterator.nextImage()) != nullptr) {
    images.push_back(pdfImage);  // BAD: pointer becomes invalid
}

// CORRECT - process each image immediately
while ((pdfImage = iterator.nextImage()) != nullptr) {
    processImage(pdfImage);  // Process before next iteration
}
```

## See Also

- [PFCPDFImageIterator](/docs/api-reference/data-structures/pfc-pdf-image-iterator)
- [PFCImageFile](/docs/api-reference/data-structures/pfc-image-file)
- [PDF Usage Example](/docs/examples/pdf)
