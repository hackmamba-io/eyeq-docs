---
title: api-torture
---

> Auto-generated from `api-torture.h`. Edit doc comments in the header and rebuild.

## API

### Macros (Constants)
- [`API_OK`](#macro-const-api-ok-0c3124a0)
- [`API_ERROR_INVALID`](#macro-const-api-error-invalid-737606e0)

### Macros (Function-like)
- [`API_MIN`](#macro-fn-api-min-1e18a824)
- [`API_LOGF`](#macro-fn-api-logf-9f9036f6)

### Typedefs
- [`ApiHandle`](#typedef-apihandle-ec505161)

### Enums
- [`ApiLogLevel`](#enum-apiloglevel-f5b171da)

### Unions
- [`variant`](#union-variant-8b5fcd2b)

### Functions
- [`init_library`](#function-init-library-94439835)
- [`shutdown_library`](#function-shutdown-library-6376fd6a)
- [`api_set_log_level`](#function-api-set-log-level-aea23ca3)
- [`http_get`](#function-http-get-390d4437)
- [`http_post_json`](#function-http-post-json-f34e77f4)
- [`http_delete`](#function-http-delete-35268277)
- [`set_log_level_legacy`](#function-set-log-level-legacy-e0628819)
- [`_internal_rehash_caches`](#function-internal-rehash-caches-0c3c9387)
- [`compute_thing`](#function-compute-thing-ad20ae98)
- [`create_handle`](#function-create-handle-2f7f9bf5)
- [`compute_wrapper`](#function-compute-wrapper-162d7d2c)
- [`resource_open`](#function-resource-open-ff34ac17)
- [`open_resource`](#function-open-resource-6eae616e)
- [`param_styles`](#function-param-styles-e3ad2275)

<a id="function-init-library-94439835"></a>
### `init_library`
Callback invoked when an async request completes.


**Signature**
```c
int init_library(const ApiConfig* cfg);
```

**Parameters**
| Name | Description |
|------|-------------|
| `status` | 0 on success, negative on error. |
| `user` | user-supplied context pointer. |

<a id="function-shutdown-library-6376fd6a"></a>
### `shutdown_library`
Shuts down the library and frees global resources.


**Warnings**
- Calling twice is undefined behavior.

**Signature**
```c
int shutdown_library(void);
```

**Returns**
0 on success.

<a id="function-api-set-log-level-aea23ca3"></a>
### `api_set_log_level`
Returns the semantic version string.


**Signature**
```c
int api_set_log_level(enum ApiLogLevel lvl);
```

**Returns**
Non-null, static, zero-terminated string.

**Example**
```c
const char* v = api_version();
printf("API %s\n", v);
```

<a id="function-http-get-390d4437"></a>
### `http_get`
Performs a GET request into a user buffer (synchronous).


**See also**
- http_post_json

**Signature**
```c
int http_get(const char* path, char* buf, int size);
```

**Parameters**
| Name | Description |
|------|-------------|
| `path` | Path portion (e.g., "/users"). |
| `buf` | Destination buffer. |
| `size` | Capacity of @p buf. |

**Returns**
0 on success; negative error code on failure.

<a id="function-http-post-json-f34e77f4"></a>
### `http_post_json`

**Signature**
```c
int http_post_json(const char* path, const char* json, char* buf, int size);
```

<a id="function-http-delete-35268277"></a>
### `http_delete`

**Signature**
```c
int http_delete(const char* path);
```

<a id="function-set-log-level-legacy-e0628819"></a>
### `set_log_level_legacy`
Inline helper that formats and logs a request line (edge-case: inline def).


**Signature**
```c
int set_log_level_legacy(int level);
```

<a id="function-internal-rehash-caches-0c3c9387"></a>
### `_internal_rehash_caches`

**Signature**
```c
int _internal_rehash_caches(void);
```

<a id="function-compute-thing-ad20ae98"></a>
### `compute_thing`
Computes something tricky.


**Notes**
- Fast-path when x==0.

**Warnings**
- Not thread-safe prior to init_library().

**TODOs**
- SIMD acceleration

**Known Bugs**
- Rare off-by-one in legacy mode

**Signature**
```c
int compute_thing(int x);
```

**Parameters**
| Name | Description |
|------|-------------|
| `x` | input value |

**Returns**
0 or negative on error.

**Errors**
- -11 overflow
- -12 domain error

<a id="function-create-handle-2f7f9bf5"></a>
### `create_handle`

**Signature**
```c
ApiHandle create_handle ( const char* name , int flags );
```

<a id="function-compute-wrapper-162d7d2c"></a>
### `compute_wrapper`
Wrapper calling [`compute_thing`](api-torture.mdx#function-compute-thing-ad20ae98) then `api_version`.


**Signature**
```c
int compute_wrapper(int x);
```

**Returns**
Whatever [`compute_thing`](api-torture.mdx#function-compute-thing-ad20ae98) returns.

<a id="function-resource-open-ff34ac17"></a>
### `resource_open`
Opens a resource.


**Signature**
```c
int resource_open(const char* uri, ApiHandle* outH);
```

**Parameters**
| Name | Description |
|------|-------------|
| `uri` | Resource identifier. |
| `outH` | Receives handle on success. |

**Returns**
0 on success; negative error code otherwise.

<a id="function-open-resource-6eae616e"></a>
### `open_resource`
Alias using @copydoc to inherit docs.


**Signature**
```c
int open_resource(const char* uri, ApiHandle* outH);
```

**Parameters**
| Name | Description |
|------|-------------|
| `uri` | Resource identifier. |
| `outH` | Receives handle on success. |

**Returns**
0 on success; negative error code otherwise.

<a id="function-param-styles-e3ad2275"></a>
### `param_styles`
> ⚠️ No doc comment found. Add a `/** ... */` block above this declaration.


**Signature**
```c
int param_styles( const char* key, ApiValue* out_value );
```

<a id="macro-const-api-ok-0c3124a0"></a>
### `API_OK`

**Value**
```c
#define API_OK 0
```

<a id="macro-const-api-error-invalid-737606e0"></a>
### `API_ERROR_INVALID`

**Value**
```c
#define API_ERROR_INVALID (-22)
```

<a id="macro-fn-api-min-1e18a824"></a>
### `API_MIN`

**Signature**
```c
#define API_MIN(a,b) /* (( (a) &lt; (b) ) ? (a) : (b)) */
```

<a id="macro-fn-api-logf-9f9036f6"></a>
### `API_LOGF`

**Signature**
```c
#define API_LOGF(fmt, ...) /* \ */
```

<a id="typedef-apihandle-ec505161"></a>
### `ApiHandle`

**Definition**
```c
typedef struct ApiHandle_t* ApiHandle;
```

<a id="enum-apiloglevel-f5b171da"></a>
### `ApiLogLevel`

**Enumerators**
| Name | Value |
|------|-------|
| `API_LOG_DEBUG` | 10 |
| `API_LOG_INFO` | 20 |
| `API_LOG_WARN` | 30 |
| `API_LOG_ERROR` | 40 |

<a id="union-variant-8b5fcd2b"></a>
### `variant`

**Members**
| Name | Type |
|------|------|
| `i` | `int` |
| `d` | `double` |

